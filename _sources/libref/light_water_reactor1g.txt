.. _bright_light_water_reactor1g:

***************************
Light Water Reactor1G Class
***************************
This class provides a model of a one energy group Light Water Reactor (LWR) that may be used out of the box.  
Additionally, this portion of the code also provides a function that returns a copy of default LWR parameters.  
Lastly, this document displays a benchmark of this LWR model to other published LWR cases.

All functionality may be found in the ``light_water_reactor1g`` module::

    import bright.light_water_reactor1g

.. currentmodule:: bright.light_water_reactor1g
    
=========================
LightWaterReactor1G Class
=========================

.. autoclass:: LightWaterReactor1G(libfile=None, reactor_parameters=None, name="")

    .. attribute:: track_params

        Light water reactors have a type specific set of data that they follow from pass-to-pass.  Thus this 
        attribute has be modified to contain following parameters: ``["BUd", "U", "TRU", "ACT", "LAN", "FP"]``. 

    .. automethod:: calc_params()

=============================
Light Water Reactor Benchmark
=============================
The following data presents the results of benchmarking this reactor model to two separate cases.  
The first is to an NEA case and the second is to a VISION case.  These benchmarks first calibrate 
the non-leakage probability to the target discharge burnup and then compare isotopics. Then the 
benchmarks use a static 0.98 value for the non-leakage probability and then compare isotopics.  
In doing so, this gives a relative measure on how much error is induced buy simply using a nominal 
value for :attr:`Reactor1G.P_NL`.  If you require more information on these benchmarks please email 
the author.

-------------
NEA Benchmark
-------------
In 1994, the Nuclear Energy Agency put out an light water reactor study entitled
"*BURNUP CREDIT  CRITICALITY BENCHMARK*", report number NEA/NSC/DOC(93)22.
Our results were benchmarked to this study as seen below::

    LWR NEA/OECD Benchmark
        Target BU: 40.0
        Batches: 4

    Calibrated to a Non-Leakage Probability of 0.991702331933

    Input Isotopics:
    Isotope      Benchmark        Model          Delta          Mean           Sigma     Fractional Dev 
    U234       3.200000E-04   3.200000E-04   0.000000E+00   3.200000E-04   0.000000E+00   0.000000E+00  
    U235       3.600000E-02   3.616000E-02   -1.600000E-04  3.608000E-02   8.000000E-05   2.217295E-03  
    U236       1.600000E-04   0.000000E+00   1.600000E-04   8.000000E-05   8.000000E-05   1.000000E+00  
    U238       9.635200E-01   9.635200E-01   0.000000E+00   9.635200E-01   0.000000E+00   0.000000E+00  

    Output Isotopics:
    Isotope      Benchmark        Model          Delta          Mean           Sigma     Fractional Dev 
    U234       1.778273E-04   1.702342E-04   7.593100E-06   1.740307E-04   3.796550E-06   2.181540E-02  
    U235       8.005087E-03   8.019370E-03   -1.428300E-05  8.012228E-03   7.141500E-06   8.913251E-04  
    U236       4.842712E-03   4.570171E-03   2.725410E-04   4.706442E-03   1.362705E-04   2.895404E-02  
    U238       9.337753E-01   9.349651E-01   -1.189800E-03  9.343702E-01   5.949000E-04   6.366855E-04  
    NP237      6.146369E-04   5.715557E-04   4.308120E-05   5.930963E-04   2.154060E-05   3.631889E-02  
    PU238      2.258085E-04   1.869517E-04   3.885680E-05   2.063801E-04   1.942840E-05   9.413892E-02  
    PU239      5.993966E-03   5.399433E-03   5.945330E-04   5.696700E-03   2.972665E-04   5.218223E-02  
    PU240      2.389836E-03   2.097440E-03   2.923960E-04   2.243638E-03   1.461980E-04   6.516114E-02  
    PU241      1.636997E-03   1.809322E-03   -1.723250E-04  1.723159E-03   8.616250E-05   5.000263E-02  
    PU242      6.026438E-04   6.960956E-04   -9.345180E-05  6.493697E-04   4.672590E-05   7.195577E-02  
    AM241      4.672990E-05   4.593505E-05   7.948500E-07   4.633248E-05   3.974250E-07   8.577677E-03  
    AM243      1.481173E-04   1.515932E-04   -3.475900E-06  1.498553E-04   1.737950E-06   1.159752E-02  
    TC99       2.227474E-03   8.991231E-04   1.328351E-03   1.563299E-03   6.641755E-04   4.248552E-01  
    SM147      1.395532E-04   5.554944E-05   8.400376E-05   9.755132E-05   4.200188E-05   4.305619E-01  
    SM151      2.881857E-05   1.877299E-05   1.004558E-05   2.379578E-05   5.022790E-06   2.110790E-01  



    However, when using a Non-Leakage Probability = 0.98
    Input Isotopics:
    Isotope      Benchmark        Model          Delta          Mean           Sigma     Fractional Dev 
    U234       3.200000E-04   3.200000E-04   0.000000E+00   3.200000E-04   0.000000E+00   0.000000E+00  
    U235       3.600000E-02   3.774542E-02   -1.745420E-03  3.687271E-02   8.727100E-04   2.366818E-02  
    U236       1.600000E-04   0.000000E+00   1.600000E-04   8.000000E-05   8.000000E-05   1.000000E+00  
    U238       9.635200E-01   9.619346E-01   1.585400E-03   9.627273E-01   7.927000E-04   8.233900E-04  

    Output Isotopics:
    Isotope      Benchmark        Model          Delta          Mean           Sigma     Fractional Dev 
    U234       1.778273E-04   1.729505E-04   4.876800E-06   1.753889E-04   2.438400E-06   1.390282E-02  
    U235       8.005087E-03   8.693066E-03   -6.879790E-04  8.349077E-03   3.439895E-04   4.120090E-02  
    U236       4.842712E-03   4.736438E-03   1.062740E-04   4.789575E-03   5.313700E-05   1.109430E-02  
    U238       9.337753E-01   9.341583E-01   -3.830000E-04  9.339668E-01   1.915000E-04   2.050394E-04      
    NP237      6.146369E-04   5.754729E-04   3.916400E-05   5.950549E-04   1.958200E-05   3.290789E-02  
    PU238      2.258085E-04   1.825275E-04   4.328100E-05   2.041680E-04   2.164050E-05   1.059936E-01  
    PU239      5.993966E-03   5.387355E-03   6.066110E-04   5.690660E-03   3.033055E-04   5.329882E-02  
    PU240      2.389836E-03   2.081707E-03   3.081290E-04   2.235771E-03   1.540645E-04   6.890888E-02      
    PU241      1.636997E-03   1.777721E-03   -1.407240E-04  1.707359E-03   7.036200E-05   4.121102E-02  
    PU242      6.026438E-04   6.624653E-04   -5.982150E-05  6.325545E-04   2.991075E-05   4.728565E-02  
    AM241      4.672990E-05   4.426752E-05   2.462380E-06   4.549871E-05   1.231190E-06   2.705989E-02  
    AM243      1.481173E-04   1.403760E-04   7.741300E-06   1.442467E-04   3.870650E-06   2.683355E-02  
    TC99       2.227474E-03   9.030060E-04   1.324468E-03   1.565240E-03   6.622340E-04   4.230878E-01  
    SM147      1.395532E-04   5.566811E-05   8.388509E-05   9.761066E-05   4.194255E-05   4.296923E-01  
    SM151      2.881857E-05   1.884253E-05   9.976040E-06   2.383055E-05   4.988020E-06   2.093120E-01  


----------------
VISION Benchmark
----------------
The light water reactor here was further benchmarked against the data in the Idaho Nat'l Lab code package 
VISION. Please contact INL for more information on their study.  The results were as follows::

    LWR Vision Benchmark
        Target BU: 51.0
        Batches: 3

    Calibrated to a Non-Leakage Probability of 1.0124196169

    Input Isotopics:
    Isotope      Benchmark        Model          Delta          Mean           Sigma     Fractional Dev 
    U234       3.439849E-04   3.439849E-04   0.000000E+00   3.439849E-04   0.000000E+00   0.000000E+00  
    U235       4.299811E-02   4.299811E-02   0.000000E+00   4.299811E-02   0.000000E+00   0.000000E+00  
    U238       9.566579E-01   9.566579E-01   0.000000E+00   9.566579E-01   0.000000E+00   0.000000E+00  

    Output Isotopics:
    Isotope      Benchmark        Model          Delta          Mean           Sigma     Fractional Dev 
    HE4        9.474578E-07   5.921823E-07   3.552755E-07   7.698200E-07   1.776377E-07   2.307523E-01  
    RA226      9.788564E-14   1.853512E-14   7.935052E-14   5.821038E-14   3.967526E-14   6.815839E-01  
    RA228      2.750878E-20   0.000000E+00   2.750878E-20   1.375439E-20   1.375439E-20   1.000000E+00      
    PB206      5.574752E-18   0.000000E+00   5.574752E-18   2.787376E-18   2.787376E-18   1.000000E+00  
    PB207      1.685925E-15   0.000000E+00   1.685925E-15   8.429625E-16   8.429625E-16   1.000000E+00  
    PB208      3.688836E-12   1.086384E-12   2.602452E-12   2.387610E-12   1.301226E-12   5.449910E-01  
    PB210      3.023865E-19   0.000000E+00   3.023865E-19   1.511933E-19   1.511933E-19   1.000000E+00  
    TH228      8.475623E-12   4.312700E-12   4.162923E-12   6.394161E-12   2.081461E-12   3.255253E-01  
    TH229      2.727879E-12   1.132899E-12   1.594980E-12   1.930389E-12   7.974900E-13   4.131240E-01  
    TH230      2.625883E-09   1.216149E-09   1.409734E-09   1.921016E-09   7.048670E-10   3.669241E-01  
    TH232      4.174814E-10   3.103601E-10   1.071213E-10   3.639208E-10   5.356065E-11   1.471767E-01  
    BI209      6.607706E-16   0.000000E+00   6.607706E-16   3.303853E-16   3.303853E-16   1.000000E+00  
    AC227      3.096862E-14   0.000000E+00   3.096862E-14   1.548431E-14   1.548431E-14   1.000000E+00  
    PA231      9.246589E-10   3.399574E-10   5.847015E-10   6.323081E-10   2.923508E-10   4.623549E-01  
    U232       1.035954E-09   9.085312E-10   1.274228E-10   9.722426E-10   6.371140E-11   6.553035E-02  
    U233       2.213901E-09   1.615250E-09   5.986510E-10   1.914576E-09   2.993255E-10   1.563404E-01  
    U234       1.718924E-04   1.620602E-04   9.832200E-06   1.669763E-04   4.916100E-06   2.944190E-02  
    U235       7.648660E-03   7.005715E-03   6.429450E-04   7.327188E-03   3.214725E-04   4.387393E-02  
    U236       5.705746E-03   5.646524E-03   5.922200E-05   5.676135E-03   2.961100E-05   5.216754E-03  
    U238       9.208590E-01   9.225728E-01   -1.713800E-03  9.217159E-01   8.569000E-04   9.296791E-04  
    NP237      6.091729E-04   8.049447E-04   -1.957718E-04  7.070588E-04   9.788590E-05   1.384410E-01  
    PU238      2.914870E-04   3.123735E-04   -2.088650E-05  3.019303E-04   1.044325E-05   3.458829E-02  
    PU239      6.065730E-03   5.377063E-03   6.886670E-04   5.721396E-03   3.443335E-04   6.018347E-02  
    PU240      2.905871E-03   2.149768E-03   7.561030E-04   2.527819E-03   3.780515E-04   1.495564E-01  
    PU241      1.757922E-03   1.972341E-03   -2.144190E-04  1.865132E-03   1.072095E-04   5.748093E-02  
    PU242      8.638616E-04   9.470689E-04   -8.320730E-05  9.054653E-04   4.160365E-05   4.594726E-02  
    PU244      2.864873E-08   9.095766E-08   -6.230893E-08  5.980320E-08   3.115446E-08   5.209498E-01  
    AM241      6.442713E-05   5.670236E-05   7.724770E-06   6.056474E-05   3.862385E-06   6.377283E-02  
    AM242M     8.533620E-07   2.306579E-06   -1.453217E-06  1.579971E-06   7.266085E-07   4.598874E-01  
    AM243      1.983912E-04   2.498947E-04   -5.150350E-05  2.241429E-04   2.575175E-05   1.148899E-01  
    CM242      2.589885E-05   2.230117E-05   3.597680E-06   2.410001E-05   1.798840E-06   7.464063E-02  
    CM243      7.709657E-07   8.420301E-07   -7.106440E-08  8.064979E-07   3.553220E-08   4.405740E-02  
    CM244      8.561619E-05   1.014125E-04   -1.579631E-05  9.351435E-05   7.898155E-06   8.445929E-02  
    CM245      5.721745E-06   4.761341E-06   9.604040E-07   5.241543E-06   4.802020E-07   9.161463E-02  
    CM246      7.295675E-07   7.358994E-07   -6.331900E-09  7.327334E-07   3.165950E-09   4.320739E-03  
    CM247      9.971556E-09   9.474887E-09   4.966690E-10   9.723221E-09   2.483345E-10   2.554035E-02  
    CM248      7.691658E-10   6.595928E-10   1.095730E-10   7.143793E-10   5.478650E-11   7.669105E-02  
    CM250      4.280810E-18   0.000000E+00   4.280810E-18   2.140405E-18   2.140405E-18   1.000000E+00  
    CF249      1.649927E-12   0.000000E+00   1.649927E-12   8.249635E-13   8.249635E-13   1.000000E+00  
    CF250      2.041909E-12   0.000000E+00   2.041909E-12   1.020954E-12   1.020954E-12   1.000000E+00  
    CF251      9.865561E-13   0.000000E+00   9.865561E-13   4.932780E-13   4.932780E-13   1.000000E+00  
    CF252      6.579707E-13   0.000000E+00   6.579707E-13   3.289853E-13   3.289853E-13   1.000000E+00  
    H3         8.584618E-08   8.801793E-08   -2.171750E-09  8.693206E-08   1.085875E-09   1.249108E-02  
    C14        4.057819E-11   4.055577E-11   2.242000E-14   4.056698E-11   1.121000E-14   2.763331E-04  
    KR81       4.216812E-11   4.356445E-11   -1.396330E-12  4.286628E-11   6.981650E-13   1.628704E-02  
    KR85       3.444847E-05   3.552926E-05   -1.080790E-06  3.498886E-05   5.403950E-07   1.544477E-02  
    SR90       7.880649E-04   7.954176E-04   -7.352700E-06  7.917412E-04   3.676350E-06   4.643373E-03  
    TC99       1.140949E-03   1.109855E-03   3.109400E-05   1.125402E-03   1.554700E-05   1.381462E-02  
    I129       2.731878E-04   2.701689E-04   3.018900E-06   2.716783E-04   1.509450E-06   5.556019E-03  
    CS134      2.300898E-04   2.438104E-04   -1.372060E-05  2.369501E-04   6.860300E-06   2.895251E-02  
    CS135      6.596706E-04   4.752209E-04   1.844497E-04   5.674458E-04   9.222485E-05   1.625263E-01  
    CS137      1.816919E-03   1.838852E-03   -2.193300E-05  1.827885E-03   1.096650E-05   5.999555E-03  



    However, when using a Non-Leakage Probability = 0.98
    Input Isotopics:
    Isotope      Benchmark        Model          Delta          Mean           Sigma     Fractional Dev 
    U234       3.439849E-04   3.439849E-04   0.000000E+00   3.439849E-04   0.000000E+00   0.000000E+00  
    U235       4.299811E-02   4.769179E-02   -4.693680E-03  4.534495E-02   2.346840E-03   5.175527E-02  
    U238       9.566579E-01   9.519642E-01   4.693700E-03   9.543111E-01   2.346850E-03   2.459209E-03  

    Output Isotopics:
    Isotope      Benchmark        Model          Delta          Mean           Sigma     Fractional Dev 
    HE4        9.474578E-07   4.411537E-07   5.063041E-07   6.943057E-07   2.531520E-07   3.646118E-01  
    RA226      9.788564E-14   0.000000E+00   9.788564E-14   4.894282E-14   4.894282E-14   1.000000E+00  
    RA228      2.750878E-20   0.000000E+00   2.750878E-20   1.375439E-20   1.375439E-20   1.000000E+00  
    PB206      5.574752E-18   0.000000E+00   5.574752E-18   2.787376E-18   2.787376E-18   1.000000E+00  
    PB207      1.685925E-15   0.000000E+00   1.685925E-15   8.429625E-16   8.429625E-16   1.000000E+00  
    PB208      3.688836E-12   4.779336E-13   3.210902E-12   2.083385E-12   1.605451E-12   7.705975E-01  
    PB210      3.023865E-19   0.000000E+00   3.023865E-19   1.511933E-19   1.511933E-19   1.000000E+00  
    TH228      8.475623E-12   3.547974E-12   4.927649E-12   6.011798E-12   2.463824E-12   4.098315E-01  
    TH229      2.727879E-12   5.341660E-13   2.193713E-12   1.631023E-12   1.096857E-12   6.724962E-01  
    TH230      2.625883E-09   1.190878E-09   1.435005E-09   1.908381E-09   7.175025E-10   3.759746E-01  
    TH232      4.174814E-10   3.039289E-10   1.135525E-10   3.607051E-10   5.677625E-11   1.574035E-01  
    BI209      6.607706E-16   0.000000E+00   6.607706E-16   3.303853E-16   3.303853E-16   1.000000E+00  
    AC227      3.096862E-14   0.000000E+00   3.096862E-14   1.548431E-14   1.548431E-14   1.000000E+00  
    PA231      9.246589E-10   3.194886E-10   6.051703E-10   6.220737E-10   3.025851E-10   4.864136E-01  
    U232       1.035954E-09   7.053947E-10   3.305593E-10   8.706743E-10   1.652796E-10   1.898295E-01  
    U233       2.213901E-09   1.669167E-09   5.447340E-10   1.941534E-09   2.723670E-10   1.402844E-01  
    U234       1.718924E-04   1.722915E-04   -3.991000E-07  1.720919E-04   1.995500E-07   1.159555E-03  
    U235       7.648660E-03   9.026950E-03   -1.378290E-03  8.337805E-03   6.891450E-04   8.265305E-02  
    U236       5.705746E-03   6.165063E-03   -4.593170E-04  5.935404E-03   2.296585E-04   3.869298E-02  
    U238       9.208590E-01   9.209260E-01   -6.700000E-05  9.208925E-01   3.350000E-05   3.637775E-05  
    NP237      6.091729E-04   8.057805E-04   -1.966076E-04  7.074767E-04   9.830380E-05   1.389499E-01  
    PU238      2.914870E-04   2.839470E-04   7.540000E-06   2.877170E-04   3.770000E-06   1.310315E-02  
    PU239      6.065730E-03   5.351660E-03   7.140700E-04   5.708695E-03   3.570350E-04   6.254231E-02  
    PU240      2.905871E-03   2.113854E-03   7.920170E-04   2.509863E-03   3.960085E-04   1.577810E-01  
    PU241      1.757922E-03   1.889951E-03   -1.320290E-04  1.823937E-03   6.601450E-05   3.619342E-02  
    PU242      8.638616E-04   8.192410E-04   4.462060E-05   8.415513E-04   2.231030E-05   2.651092E-02  
    PU244      2.864873E-08   6.675411E-08   -3.810538E-08  4.770142E-08   1.905269E-08   3.994156E-01  
    AM241      6.442713E-05   5.140456E-05   1.302257E-05   5.791585E-05   6.511285E-06   1.124267E-01  
    AM242M     8.533620E-07   2.055876E-06   -1.202514E-06  1.454619E-06   6.012570E-07   4.133433E-01  
    AM243      1.983912E-04   1.977226E-04   6.686000E-07   1.980569E-04   3.343000E-07   1.687899E-03  
    CM242      2.589885E-05   1.904885E-05   6.850000E-06   2.247385E-05   3.425000E-06   1.523993E-01  
    CM243      7.709657E-07   6.590578E-07   1.119079E-07   7.150117E-07   5.595395E-08   7.825599E-02  
    CM244      8.561619E-05   7.200838E-05   1.360781E-05   7.881229E-05   6.803905E-06   8.633051E-02  
    CM245      5.721745E-06   3.200235E-06   2.521510E-06   4.460990E-06   1.260755E-06   2.826178E-01  
    CM246      7.295675E-07   4.420492E-07   2.875183E-07   5.858083E-07   1.437592E-07   2.454030E-01  
    CM247      9.971556E-09   5.191190E-09   4.780366E-09   7.581373E-09   2.390183E-09   3.152705E-01  
    CM248      7.691658E-10   3.260302E-10   4.431356E-10   5.475980E-10   2.215678E-10   4.046176E-01  
    CM250      4.280810E-18   0.000000E+00   4.280810E-18   2.140405E-18   2.140405E-18   1.000000E+00  
    CF249      1.649927E-12   0.000000E+00   1.649927E-12   8.249635E-13   8.249635E-13   1.000000E+00  
    CF250      2.041909E-12   0.000000E+00   2.041909E-12   1.020954E-12   1.020954E-12   1.000000E+00  
    CF251      9.865561E-13   0.000000E+00   9.865561E-13   4.932780E-13   4.932780E-13   1.000000E+00  
    CF252      6.579707E-13   0.000000E+00   6.579707E-13   3.289853E-13   3.289853E-13   1.000000E+00  
    H3         8.584618E-08   8.570097E-08   1.452100E-10   8.577358E-08   7.260500E-11   8.464728E-04  
    C14        4.057819E-11   4.016754E-11   4.106500E-13   4.037286E-11   2.053250E-13   5.085718E-03  
    KR81       4.216812E-11   3.788124E-11   4.286880E-12   4.002468E-11   2.143440E-12   5.355296E-02  
    KR85       3.444847E-05   3.666288E-05   -2.214410E-06  3.555568E-05   1.107205E-06   3.114004E-02  
    SR90       7.880649E-04   8.229478E-04   -3.488290E-05  8.055064E-04   1.744145E-05   2.165278E-02  
    TC99       1.140949E-03   1.113226E-03   2.772300E-05   1.127087E-03   1.386150E-05   1.229851E-02  
    I129       2.731878E-04   2.615696E-04   1.161820E-05   2.673787E-04   5.809100E-06   2.172611E-02  
    CS134      2.300898E-04   2.334493E-04   -3.359500E-06  2.317695E-04   1.679750E-06   7.247501E-03  
    CS135      6.596706E-04   4.611292E-04   1.985414E-04   5.603999E-04   9.927070E-05   1.771426E-01  
    CS137      1.816919E-03   1.822007E-03   -5.088000E-06  1.819463E-03   2.544000E-06   1.398215E-03  
